<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–°–∞–π—Ç –î–æ–ª–±–∞—ë–±–∞</title>
    <style>
    /* ===== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ===== */
    * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        margin: 0;
        padding: 0;
    }
    
    body {
        background: #0a0a0a;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        padding: 16px;
        transition: background 0.3s;
    }
    
    .container {
        max-width: 1200px;
        margin: 0 auto;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    @media (min-width: 768px) {
        .button-grid {
            display: flex;
            gap: 30px;
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
            margin: 20px 0;
        }
        
        .hello, .poka {
            width: 280px;
            height: 280px;
            font-size: 44px;
            margin: 0;
        }
    }
    
    .counter {
        background: #111;
        border: 2px solid #f0f;
        border-radius: 60px;
        padding: 16px 24px;
        margin: 20px 0;
        text-align: center;
        font-size: clamp(18px, 5vw, 24px);
        color: #fff;
        position: relative;
        z-index: 5;
        width: 100%;
        max-width: 500px;
        box-shadow: 0 0 20px rgba(255, 0, 255, 0.3);
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 10px;
    }
    
    .counter span {
        margin: 0 10px;
        display: inline-block;
        white-space: nowrap;
    }
    
    .counter span span {
        color: #f0f;
        font-weight: 700;
        font-size: clamp(22px, 6vw, 28px);
        margin: 0 5px;
    }

    .ghost-progress {
        color: #f0f;
        font-size: clamp(14px, 4vw, 18px);
        background: #222;
        padding: 5px 15px;
        border-radius: 30px;
        border: 1px solid #f0f;
        display: inline-block;
        margin-left: 10px;
    }
    
    .rainbow-title {
        text-align: center;
        font-size: clamp(28px, 8vw, 48px);
        margin: 20px 0 10px;
        font-weight: 800;
        background: linear-gradient(45deg, 
            #ff0000, #ff8800, #ffff00, #00ff00, 
            #0088ff, #0000ff, #8800ff, #ff00ff);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        animation: rainbow 4s linear infinite;
        background-size: 300% 300%;
        max-width: 100%;
        word-break: break-word;
    }
    
    @keyframes rainbow {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
    
    .hello, .poka {
        width: 240px;
        height: 240px;
        margin: 12px auto;
        text-align: center;
        line-height: 240px;
        font-size: 38px;
        font-weight: 600;
        border-radius: 40px;
        cursor: pointer;
        border: 3px solid #f0f;
        position: relative;
        z-index: 5;
        transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 0 25px currentColor;
        user-select: none;
        touch-action: manipulation;
    }
    
    .hello {
        background: #0ff;
        color: #111;
    }
    
    .poka {
        background: #ff0;
        color: #111;
    }
    
    @media (hover: hover) and (pointer: fine) {
        .hello:hover {
            transform: scale(1.05) rotate(-1deg);
            background: #0ff;
            filter: brightness(1.2);
            box-shadow: 0 0 40px #0ff;
        }
        
        .poka:hover {
            transform: scale(1.05) rotate(1deg);
            background: #ff0;
            filter: brightness(1.2);
            box-shadow: 0 0 40px #ff0;
        }
        
        a:hover {
            transform: scale(1.1);
            color: #ff0;
            text-shadow: 0 0 15px #0f0;
        }
        
        .theme-btn:hover {
            background: #f0f;
            color: #111;
            box-shadow: 0 0 30px #f0f;
        }
        
        .secret:hover {
            background: #222;
            color: #fff;
            border-color: #f0f;
        }
    }
    
    .hello:active, .poka:active {
        transform: scale(0.92) rotate(2deg);
        filter: brightness(1.5);
        box-shadow: 0 0 40px currentColor;
    }
    
    .hello:active {
        background: #00f;
        color: #fff;
    }
    
    .poka:active {
        background: #f80;
        color: #fff;
    }
    
    a {
        display: block;
        text-align: center;
        font-size: clamp(24px, 6vw, 36px);
        margin: 20px;
        color: #0f0;
        text-decoration: none;
        font-weight: 500;
        padding: 12px 24px;
        position: relative;
        z-index: 5;
        transition: all 0.2s ease;
        border: 2px solid transparent;
        border-radius: 50px;
    }
    
    a:active {
        transform: scale(0.95);
        color: #f00;
        border-color: #f00;
    }
    
    .hello-window {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        width: min(280px, 80vw);
        height: min(150px, 40vh);
        background: #111;
        border: 3px solid #f0f;
        border-radius: 40px;
        text-align: center;
        font-size: clamp(32px, 8vw, 48px);
        color: #f0f;
        line-height: min(150px, 40vh);
        z-index: 10000;
        box-shadow: 0 0 50px #f0f;
        animation: pop 0.2s forwards;
        cursor: pointer;
    }
    
    @keyframes pop {
        to { transform: translate(-50%, -50%) scale(1); }
    }
    
    .hello-window.fade-out {
        animation: popout 0.2s forwards;
    }
    
    @keyframes popout {
        to { transform: translate(-50%, -50%) scale(0); }
    }
    
    .scary-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #f33;
        display: none;
        z-index: 9000;
        text-align: center;
        color: #fff;
        font-size: clamp(40px, 15vw, 80px);
        line-height: 100vh;
        animation: fadeIn 0.15s;
        cursor: pointer;
        font-weight: 800;
        text-shadow: 0 0 30px #000;
        position: fixed;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    .message {
        position: fixed;
        background: #111;
        border: 3px solid;
        border-radius: 60px;
        padding: clamp(12px, 4vw, 16px) clamp(20px, 6vw, 32px);
        font-size: clamp(20px, 6vw, 32px);
        font-weight: 600;
        z-index: 9500;
        pointer-events: none;
        animation: msg 0.5s forwards;
        white-space: nowrap;
        transform: translate(-50%, -50%);
        box-shadow: 0 0 30px currentColor;
        will-change: transform, left, top;
    }
    
    @media (max-width: 480px) {
        .message {
            white-space: normal;
            text-align: center;
            max-width: 80vw;
            font-size: clamp(18px, 5vw, 24px);
            padding: 10px 16px;
        }
    }
    
    @keyframes msg {
        0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
        20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
        80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
    }
    
    .ghost {
        position: fixed;
        font-size: clamp(60px, 20vw, 100px);
        z-index: 2000;
        pointer-events: auto;
        filter: drop-shadow(0 0 30px #f0f);
        animation: ghostFloat 4.5s infinite ease-in-out;
        text-shadow: 0 0 20px #f0f, 0 0 40px #ff00ff;
        transform: translate(-50%, -50%);
        transition: all 3s cubic-bezier(0.2, 0.1, 0.3, 1);
        display: none;
        top: 50%;
        left: 50%;
        will-change: top, left;
        cursor: pointer;
    }
    
    @keyframes ghostFloat {
        0% { transform: translate(-50%, -50%) translateY(0); }
        50% { transform: translate(-50%, -50%) translateY(-30px); }
        100% { transform: translate(-50%, -50%) translateY(0); }
    }
    
    .ghost-message {
        position: fixed;
        background: rgba(17, 17, 17, 0.98);
        border: 3px solid #f0f;
        border-radius: 40px;
        padding: clamp(10px, 3vw, 15px) clamp(15px, 5vw, 25px);
        color: #f0f;
        font-size: clamp(18px, 5vw, 26px);
        z-index: 2001;
        pointer-events: none;
        animation: ghostMessage 2.5s forwards;
        white-space: nowrap;
        box-shadow: 0 0 40px #f0f;
        max-width: 90vw;
        text-align: center;
        word-wrap: break-word;
        transform: translate(-50%, -50%);
    }
    
    @media (max-width: 480px) {
        .ghost-message {
            white-space: normal;
            max-width: 85vw;
        }
    }
    
    @keyframes ghostMessage {
        0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
        20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
        70% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
    }
  .theme-btn {
    text-align: center;
    font-size: clamp(18px, 4vw, 22px);
    margin: 15px auto;
    padding: 14px 28px;
    cursor: pointer;
    border: 3px solid #f0f;
    border-radius: 60px;
    background: #111;
    color: #f0f;
    width: fit-content;
    transition: all 0.3s ease;
    box-shadow: 0 0 20px #f0f;
    font-weight: 500;
    touch-action: manipulation;
    user-select: none;
    z-index: 5;
}

.theme-btn:active {
    transform: scale(0.95);
    background: #f0f;
    color: #111;
}

.secret {
    text-align: center;
    font-size: clamp(16px, 4vw, 18px);
    color: #666;
    margin: 10px;
    padding: 14px 24px;
    cursor: pointer;
    border: 2px solid #333;
    border-radius: 50px;
    background: #111;
    position: relative;
    z-index: 5;
    transition: all 0.2s;
    width: fit-content;
    min-width: 200px;
    font-weight: 500;
    touch-action: manipulation;
    user-select: none;
}

.secret:active {
    background: #222;
    color: #fff;
    border-color: #f0f;
}

.footer {
    text-align: center;
    color: #444;
    font-size: clamp(12px, 3vw, 14px);
    margin: 20px;
    position: relative;
    z-index: 5;
}

.glitch-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    display: none;
    z-index: 9500;
}

.glitch-layer {
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
        0deg,
        #f33 0px,
        #3f3 2px,
        #33f 4px,
        transparent 6px
    );
    mix-blend-mode: screen;
    animation: glitch 0.1s infinite;
}

@keyframes glitch {
    0% { transform: translate(0, 0); }
    25% { transform: translate(-5px, 5px); }
    50% { transform: translate(5px, -5px); }
    75% { transform: translate(-5px, -5px); }
    100% { transform: translate(0, 0); }
}

.matrix-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    display: none;
    z-index: 10000;
    overflow: hidden;
}

.matrix-column {
    position: absolute;
    top: -100%;
    width: clamp(12px, 4vw, 18px);
    text-align: center;
    font-family: 'Courier New', monospace;
    font-size: clamp(14px, 4vw, 18px);
    line-height: clamp(16px, 4.5vw, 20px);
    white-space: nowrap;
    animation: matrixFall linear infinite;
}

.matrix-char {
    display: block;
    color: #0f0;
}

@keyframes matrixFall {
    0% { transform: translateY(0); }
    100% { transform: translateY(200vh); }
}

.light-theme {
    background: #f5f5f5;
}

.light-theme .counter,
.light-theme .secret,
.light-theme .theme-btn {
    background: #fff;
    color: #111;
    border-color: #f0f;
    box-shadow: 0 0 20px rgba(255, 0, 255, 0.3);
}

.light-theme .counter span span {
    color: #f0f;
}

.light-theme a {
    color: #00f;
}

.light-theme .footer {
    color: #888;
}

.light-theme .secret {
    border-color: #f0f;
    color: #333;
}

@media (min-width: 1024px) {
    .container {
        max-width: 800px;
    }
    
    .button-grid {
        display: flex;
        gap: 40px;
        margin: 30px 0;
    }
    
    .hello, .poka {
        width: 300px;
        height: 300px;
        font-size: 48px;
        line-height: 300px;
    }
}

/* ===== –°–¢–ò–õ–ò –ß–ê–¢–ê ===== */
.chat-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 20000;
    display: none;
    flex-direction: column;
    backdrop-filter: blur(5px);
}

.chat-container.active {
    display: flex;
}

.chat-header {
    background: #111;
    border-bottom: 2px solid #f0f;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #f0f;
    font-size: clamp(18px, 5vw, 24px);
    font-weight: 600;
    box-shadow: 0 0 20px #f0f;
}

.chat-header span {
    display: flex;
    align-items: center;
    gap: 10px;
}

.chat-close {
    background: none;
    border: 2px solid #f0f;
    color: #f0f;
    font-size: clamp(20px, 6vw, 28px);
    width: 50px;
    height: 50px;
    border-radius: 25px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.chat-close:active {
    background: #f0f;
    color: #111;
    transform: scale(0.9);
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    scroll-behavior: smooth;
}

/* –ö–û–ù–¢–ï–ô–ù–ï–† –°–û–û–ë–©–ï–ù–ò–ô */
#chatMessages {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    background: #0a0a0a;
    width: 100%;
}
      /* –¢–í–û–ò –°–û–û–ë–©–ï–ù–ò–Ø (—Å–ø—Ä–∞–≤–∞) */
    .message-bubble.user {
        background: #f0f;
        color: #111;
        border-radius: 18px 18px 5px 18px;
        padding: 10px 14px;
        max-width: 75%;
        font-size: 16px;
        line-height: 1.4;
        word-wrap: break-word;
        align-self: flex-end;
        margin-left: auto;
        text-align: left;
        display: block;
    }

    /* –°–û–û–ë–©–ï–ù–ò–Ø –ü–†–ò–ó–†–ê–ö–ê (—Å–ª–µ–≤–∞) */
    .message-bubble.ghost {
        background: #333;
        color: #f0f;
        border: 1px solid #f0f;
        border-radius: 18px 18px 18px 5px;
        padding: 10px 14px;
        max-width: 75%;
        font-size: 16px;
        line-height: 1.4;
        word-wrap: break-word;
        align-self: flex-start;
        margin-right: auto;
        text-align: left;
        display: block;
    }

    .message-time {
        font-size: 10px;
        opacity: 0.6;
        margin-top: 4px;
        text-align: right;
    }
    
    .chat-input {
        flex: 1;
        background: #222;
        border: 2px solid #f0f;
        border-radius: 30px;
        padding: 12px 20px;
        color: #fff;
        font-size: clamp(16px, 4vw, 18px);
        outline: none;
    }
    
    .chat-input:focus {
        box-shadow: 0 0 20px #f0f;
    }
    
    .chat-send {
        background: #f0f;
        border: none;
        color: #111;
        font-size: clamp(18px, 5vw, 22px);
        padding: 12px 25px;
        border-radius: 30px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.2s;
        white-space: nowrap;
    }
    
    .chat-send:active {
        transform: scale(0.9);
        background: #fff;
    }
    
    .typing-indicator {
        display: flex;
        gap: 5px;
        padding: 10px;
        background: #222;
        border-radius: 20px;
        width: fit-content;
        border: 1px solid #f0f;
        align-self: flex-start;
        margin-left: 0;
        margin-right: auto;
    }
    
    .typing-indicator span {
        width: 8px;
        height: 8px;
        background: #f0f;
        border-radius: 50%;
        animation: typing 1s infinite;
    }
    
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
    
    @keyframes typing {
        0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
        30% { transform: translateY(-10px); opacity: 1; }
    }
    
    @media (max-width: 480px) {
        .message-bubble {
            max-width: 90%;
        }    
    }

    /* –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ü–û–õ–Ø –í–í–û–î–ê */
    .chat-input-area {
        display: flex !important;
        background: #111 !important;
        border-top: 2px solid #f0f !important;
        padding: 15px 20px !important;
        gap: 10px !important;
        align-items: center !important;
        visibility: visible !important;
        opacity: 1 !important;
        height: auto !important;
        min-height: 70px !important;
    }

    .chat-input {
        display: block !important;
        background: #222 !important;
        border: 2px solid #f0f !important;
        border-radius: 30px !important;
        padding: 12px 20px !important;
        color: #fff !important;
        font-size: 16px !important;
        flex: 1 !important;
        min-width: 50px !important;
        visibility: visible !important;
        opacity: 1 !important;
    }

    .chat-send {
        display: block !important;
        background: #f0f !important;
        border: none !important;
        color: #111 !important;
        font-size: 18px !important;
        padding: 12px 25px !important;
        border-radius: 30px !important;
        cursor: pointer !important;
        font-weight: 600 !important;
        white-space: nowrap !important;
        visibility: visible !important;
        opacity: 1 !important;
    }

    /* –ö–æ–Ω—Å–æ–ª—å —Å–≤–µ—Ä—Ö—É */
    #phoneConsole {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        background: #000 !important;
        color: #0f0 !important;
        font-size: 12px !important;
        padding: 5px !important;
        z-index: 99999 !important;
        border-bottom: 2px solid #f0f !important;
        max-height: 80px !important;
        overflow-y: auto !important;
        font-family: monospace !important;
        pointer-events: none !important;
    }
    </style>
</head>
<body>
<div class="container">
    <div id="helloWindowContainer"></div>
    
    <div class="scary-screen" id="scary" ondblclick="closeScaryNow()">–ë–£–£–£! üëª</div>
    
    <div class="ghost" id="ghost" onclick="handleGhostClick()">üëª</div>
    
    <div class="glitch-screen" id="glitch">
        <div class="glitch-layer"></div>
    </div>
    
    <div class="matrix-screen" id="matrix">
        <div id="matrixColumns"></div>
    </div>
    
    <!-- –ß–ê–¢ -->
    <div class="chat-container" id="chatContainer">
        <div class="chat-header">
            <span>
                <span>üëª 8-–ë–ò–¢–ù–´–ô –ü–†–ò–ó–†–ê–ö</span>
            </span>
            <button class="chat-close" onclick="closeChat()">‚úï</button>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" id="chatInput" placeholder="–ù–∞–ø–∏—à–∏ –ø—Ä–∏–∑—Ä–∞–∫—É..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button class="chat-send" onclick="sendMessage()">‚û§</button>
        </div>
    </div>
      <div class="counter">
        <span>–ø—Ä–∏–≤–µ—Ç <span id="helloCount">0</span></span>
        <span>–ø–æ–∫–∞ <span id="pokaCount">0</span></span>
        <span class="ghost-progress" id="ghostProgress" style="display: none;">üëª 0/100</span>
    </div>
    
    <h1 class="rainbow-title">–ü–†–ò–í–ï–¢, –î–û–õ–ë–û–Å–ë)</h1>
    
    <div class="button-grid">
        <div class="hello" onclick="handleHelloClick()">–ü–†–ò–í–ï–¢</div>
        <div class="poka" onclick="handlePokaClick()">–ü–û–ö–ê</div>
    </div>
    
    <a href="#" id="virusLink" onclick="virusClick()">–í–ò–†–£–°!!!</a>
    
    <div class="theme-btn" onclick="toggleTheme()">üåì –°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É</div>
    
    <div class="secret" onclick="showSecret()">ü§´ —Å–µ–∫—Ä–µ—Ç–∏–∫</div>
    <div class="secret" onclick="resetRecords()" style="margin-top: 5px;">üóëÔ∏è —Å–±—Ä–æ—Å —Ä–µ–∫–æ—Ä–¥–æ–≤</div>
    
    <div class="footer">—Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –¥–æ–ª–±–æ—ë–±–æ–≤ ‚ù§Ô∏è</div>
</div>

<script>
// ===== –ö–û–ù–°–¢–ê–ù–¢–´ =====
const helloPhrases = ["–û–ü–Ø–¢–¨?!","–°–ù–û–í–ê?!","–ó–ê–ï–ë–ê–õ!","–î–û–°–¢–ê–õ!","–•–í–ê–¢–ò–¢!","–ë–ï–°–ò–¢!","–ü–ò–ó–î–ï–¶!","–î–û–õ–ë–ê–Å–ë!","–£–†–û–î!","–°–î–û–•–ù–ò!"];
const pokaPhrases = ["–ù–ï –ó–ê–ï–ë–ê–õ–û?","–û–°–¢–ê–ù–û–í–ò–°–¨!","–°–£–ö–ê!","–£–Å–ë–û–ö!","–£–Å–ë–´–í–ê–ô","–°–¢–†–ê–®–ù–û?","–ì–û–ù–î–û–ù–ò–©–ï!","–û–¢–™–ï–ë–ò–°–¨ –£–ñ–ï!","–ï–ë–ê–ù–£–¢–´–ô?","–ü–û–®–Å–õ –ù–ê–•–£–ô!"];
const colors = ["#f33","#f83","#fc3","#ff3","#8f3","#3f3","#3f8","#3ff","#38f","#33f"];

// ===== –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
let helloCount = 0, pokaCount = 0, ghostHelloClicks = 0, chatUnlocked = false;
let currentSound = null, glitchSound = null, matrixInterval = null, ghostActive = false;
let ghostMessageInterval = null, ghostMusic = null, isSpecialMode = false;
let matrixClickCount = 0, lastTalkTime = 0, scaryTimeout = null;
let activeMessagePositions = [];
let chatContext = [];
const MAX_CONTEXT = 6;
  // ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====
function getElementPosition(element) {
    if (!element) return null;
    const rect = element.getBoundingClientRect();
    return {
        top: rect.top, left: rect.left, right: rect.right, bottom: rect.bottom,
        width: rect.width, height: rect.height,
        centerX: rect.left + rect.width/2, centerY: rect.top + rect.height/2
    };
}

function isPositionOverlapping(pos1, pos2, tolerance = 60) {
    return !(pos2.right + tolerance < pos1.left - tolerance || 
             pos2.left - tolerance > pos1.right + tolerance || 
             pos2.bottom + tolerance < pos1.top - tolerance || 
             pos2.top - tolerance > pos1.bottom + tolerance);
}

function findFreePositionForMessage(targetElement, maxAttempts = 200) {
    const targetPos = getElementPosition(targetElement);
    if (!targetPos) return null;
    for (let a = 0; a < maxAttempts; a++) {
        let top = 5 + Math.random()*85, left = 5 + Math.random()*85;
        let topPx = (top/100)*innerHeight, leftPx = (left/100)*innerWidth;
        let w = Math.min(300, innerWidth*0.8), h = Math.min(80, innerHeight*0.15);
        let msgPos = { left: leftPx - w/2, right: leftPx + w/2, top: topPx - h/2, bottom: topPx + h/2 };
        if (!isPositionOverlapping(targetPos, msgPos)) return { top, left };
    }
    return { top: 10+Math.random()*30, left: 10+Math.random()*30 };
}

function findPositionOnScaryScreenBalanced(scary, textEl, existing = []) {
    const scaryPos = getElementPosition(scary);
    const textPos = getElementPosition(textEl);
    if (!scaryPos || !textPos) return null;
    const expanded = { left: textPos.left-80, right: textPos.right+80, top: textPos.top-60, bottom: textPos.bottom+60 };
    const zones = [
        { top:[5,35], left:[5,35] }, { top:[5,35], left:[65,95] }, { top:[65,95], left:[5,35] }, { top:[65,95], left:[65,95] },
        { top:[5,25], left:[35,65] }, { top:[75,95], left:[35,65] }, { top:[35,65], left:[5,25] }, { top:[35,65], left:[75,95] }
    ];
    for (let z of zones.sort(()=>Math.random()-0.5)) {
        for (let a=0; a<40; a++) {
            let top = z.top[0] + Math.random()*(z.top[1]-z.top[0]);
            let left = z.left[0] + Math.random()*(z.left[1]-z.left[0]);
            let topPx = (top/100)*innerHeight, leftPx = (left/100)*innerWidth;
            let w = Math.min(280, innerWidth*0.7), h = Math.min(70, innerHeight*0.12);
            let msgPos = { left: leftPx-w/2, right: leftPx+w/2, top: topPx-h/2, bottom: topPx+h/2 };
            if (msgPos.left < scaryPos.left+15 || msgPos.right > scaryPos.right-15 || msgPos.top < scaryPos.top+15 || msgPos.bottom > scaryPos.bottom-15) continue;
            if (!(msgPos.right < expanded.left || msgPos.left > expanded.right || msgPos.bottom < expanded.top || msgPos.top > expanded.bottom)) continue;
            let overlap = existing.some(e => isPositionOverlapping(e, msgPos, 70));
            if (!overlap) return { top, left, position: msgPos };
        }
    }
    const corners = [{top:10,left:10},{top:10,left:90},{top:90,left:10},{top:90,left:90}];
    for (let c of corners) {
        let topPx = (c.top/100)*innerHeight, leftPx = (c.left/100)*innerWidth;
        let w = Math.min(280, innerWidth*0.7), h = Math.min(70, innerHeight*0.12);
        let msgPos = { left: leftPx-w/2, right: leftPx+w/2, top: topPx-h/2, bottom: topPx+h/2 };
        if (msgPos.left < scaryPos.left || msgPos.right > scaryPos.right || msgPos.top < scaryPos.top || msgPos.bottom > scaryPos.bottom) continue;
        if (!(msgPos.right < expanded.left || msgPos.left > expanded.right || msgPos.bottom < expanded.top || msgPos.top > expanded.bottom)) continue;
        return { top: c.top, left: c.left, position: msgPos };
    }
    return null;
}

function findGhostMessagePosition(ghost, existing = []) {
    const pos = getElementPosition(ghost);
    if (!pos) return null;
    const sw = innerWidth, sh = innerHeight;
    const cx = pos.centerX, cy = pos.centerY;
    const dL = cx, dR = sw-cx, dT = cy, dB = sh-cy;
    const min = Math.min(dL, dR, dT, dB);
    let offX = 0, offY = 0;
    if (min === dL) { offX = 25; offY = -10+Math.random()*20; }
    else if (min === dR) { offX = -25; offY = -10+Math.random()*20; }
    else if (min === dT) { offX = -15+Math.random()*30; offY = 25; }
    else { offX = -15+Math.random()*30; offY = -25; }
    for (let a=0; a<30; a++) {
        let left = pos.left/sw*100 + offX + (Math.random()-0.5)*15;
        let top = pos.top/sh*100 + offY + (Math.random()-0.5)*15;
        left = Math.min(92, Math.max(8, left));
        top = Math.min(92, Math.max(8, top));
        let leftPx = (left/100)*sw, topPx = (top/100)*sh;
        let w = Math.min(250, sw*0.6), h = Math.min(60, sh*0.1);
        let msgPos = { left: leftPx-w/2, right: leftPx+w/2, top: topPx-h/2, bottom: topPx+h/2 };
        if (isPositionOverlapping(pos, msgPos, 30)) continue;
        if (existing.some(e => isPositionOverlapping(e, msgPos, 50))) continue;
        return { top, left, position: msgPos };
    }
    return { top: pos.top/sh*100-15, left: pos.left/sw*100, position: null };
}
  // ===== –ó–í–£–ö =====
function stopCurrentSound() { if (currentSound) { currentSound.pause(); currentSound.currentTime = 0; currentSound = null; } }

// ===== –ó–ê–ì–†–£–ó–ö–ê =====
window.onload = function() {
    let h = localStorage.getItem('helloCount');
    let p = localStorage.getItem('pokaCount');
    if (h) { helloCount = parseInt(h); document.getElementById('helloCount').innerHTML = helloCount; }
    if (p) { pokaCount = parseInt(p); document.getElementById('pokaCount').innerHTML = pokaCount; if (pokaCount>=50 && !ghostActive) activateGhost(); }
    setTimeout(()=>alert('–ó–¥–∞—Ä–æ–≤–∞, –¥–æ–ª–±–æ—ë–±! üëã'),500);
};

// ===== 8-–ë–ò–¢–ù–ê–Ø –ú–£–ó–´–ö–ê =====
function create8BitMusic() {
    let ctx = new (window.AudioContext || window.webkitAudioContext)();
    let osc1 = ctx.createOscillator(), osc2 = ctx.createOscillator(), osc3 = ctx.createOscillator();
    [osc1,osc2,osc3].forEach(o => { o.type = 'square'; });
    osc1.frequency.value = 330; osc2.frequency.value = 415; osc3.frequency.value = 523;
    let g1 = ctx.createGain(), g2 = ctx.createGain(), g3 = ctx.createGain();
    osc1.connect(g1); osc2.connect(g2); osc3.connect(g3);
    g1.connect(ctx.destination); g2.connect(ctx.destination); g3.connect(ctx.destination);
    g1.gain.value = 0.07; g2.gain.value = 0.07; g3.gain.value = 0.07;
    osc1.start(); osc2.start(); osc3.start();
    let interval = setInterval(()=>{
        if (isSpecialMode) { g1.gain.value=0.02; g2.gain.value=0.02; g3.gain.value=0.02; }
        else {
            let notes = [262,330,392,523,659,784];
            let n = notes[Math.floor(Math.random()*notes.length)];
            osc1.frequency.value = n; osc2.frequency.value = n*1.25; osc3.frequency.value = n*1.5;
            g1.gain.value = 0.05+Math.random()*0.05; g2.gain.value = 0.05+Math.random()*0.05; g3.gain.value = 0.05+Math.random()*0.05;
        }
    },300);
    return { stop: ()=>{ clearInterval(interval); osc1.stop(); osc2.stop(); osc3.stop(); ctx.close(); }, setSpecialMode: (m)=>isSpecialMode=m };
}
  // ===== –ê–ö–¢–ò–í–ê–¶–ò–Ø –ü–†–ò–í–ò–î–ï–ù–ò–Ø =====
function activateGhost() {
    ghostActive = true;
    let g = document.getElementById('ghost');
    g.style.top = '50%'; g.style.left = '50%'; g.style.display = 'block';
    ghostMusic = create8BitMusic();
    document.getElementById('ghostProgress').style.display = 'inline-block';
    setTimeout(()=>talk("–Ø –ü–†–ò–®–Å–õ! üëª"),500);
    setTimeout(()=>{
        ghostMessageInterval = setInterval(()=>{
            if (ghostActive && !isSpecialMode) {
                if (Math.random()>0.4) talk();
                if (Math.random()>0.6) moveGhostSmoothly();
            }
        },4500);
    },1500);
}

function moveGhostSmoothly() {
    if (!ghostActive) return;
    let g = document.getElementById('ghost');
    g.style.top = (10+Math.random()*80)+'%';
    g.style.left = (10+Math.random()*80)+'%';
}

// ===== –†–ï–ß–¨ –ü–†–ò–í–ò–î–ï–ù–ò–Ø =====
function talk(custom=null) {
    if (!ghostActive || isSpecialMode) return;
    let now = Date.now();
    if (now - lastTalkTime < 3000) return;
    lastTalkTime = now;
    let msgs = ["8-–ë–ò–¢–ù–´–ô –ü–†–ò–ó–†–ê–ö","–¢–£-–¢–£-–¢–£-–¢–£ üëª","–ú–£–ó–´–ö–ê –ò–ì–†–ê–ï–¢","–ü–ò-–£-–ü–ò-–£","–Ø –í –¢–í–û–ï–ú –¢–ï–õ–ï–§–û–ù–ï","üéµ üé∂ üéµ","–ë–ò–ü-–ë–û–ü","8 –ë–ò–¢ –≠–¢–û –ö–†–£–¢–û","–ù–ï –ë–û–ô–°–Ø","–°–õ–´–®–ò–®–¨?","–¢–£–î–£-–î–£-–î–£","–Ø –ü–†–ò–ó–†–ê–ö","–¢–´ –ú–ï–ù–Ø –°–õ–´–®–ò–®–¨?","8 –ë–ò–¢ –ù–ê–í–°–ï–ì–î–ê","–ë–£-–ë–£-–ë–£ üëª"];
    let text = custom || msgs[Math.floor(Math.random()*msgs.length)];
    let ghost = document.getElementById('ghost');
    if (!window.ghostMessagePositions) window.ghostMessagePositions = [];
    setTimeout(()=>window.ghostMessagePositions=[],2600);
    let pos = findGhostMessagePosition(ghost, window.ghostMessagePositions);
    let msg = document.createElement('div');
    msg.className = 'ghost-message';
    msg.textContent = text;
    msg.style.color = '#f0f';
    msg.style.borderColor = '#f0f';
    if (pos) {
        msg.style.top = pos.top+'%';
        msg.style.left = pos.left+'%';
        if (pos.position) window.ghostMessagePositions.push(pos.position);
    } else {
        let gt = parseFloat(ghost.style.top);
        let gl = parseFloat(ghost.style.left);
        msg.style.top = (gt-15)+'%';
        msg.style.left = gl+'%';
    }
    document.body.appendChild(msg);
    setTimeout(()=>msg.remove(),2500);
}

// ===== –ö–õ–ò–ö –ü–û –ü–†–ò–í–ò–î–ï–ù–ò–Æ =====
function handleGhostClick() { if (ghostActive && !chatUnlocked) talk("*–ö–•... –ö–õ–ò–ö!*"); }
  // ===== –ö–ù–û–ü–ö–ê –ü–†–ò–í–ï–¢ =====
function handleHelloClick() {
    helloCount++;
    document.getElementById('helloCount').innerHTML = helloCount;
    localStorage.setItem('helloCount', helloCount);
    if (ghostActive && !chatUnlocked) {
        ghostHelloClicks++;
        document.getElementById('ghostProgress').innerHTML = `üëª ${ghostHelloClicks}/100`;
        if (ghostHelloClicks % 10 === 0) talk(`–ï–©–Å ${100-ghostHelloClicks} –†–ê–ó...`);
        if (ghostHelloClicks >= 100 && !chatUnlocked) unlockChat();
    }
    if (!ghostActive) {
        showMessage('hello');
        let c = document.getElementById('helloWindowContainer');
        c.innerHTML = '';
        let win = document.createElement('div');
        win.className = 'hello-window';
        win.textContent = '–ü–†–ò–í–ï–¢! ‚ù§Ô∏è';
        win.onclick = function() { this.classList.add('fade-out'); stopCurrentSound(); setTimeout(()=>this.remove(),150); };
        c.appendChild(win);
        setTimeout(()=>{ let p = findFreePositionForMessage(win); showMessage('hello',p); },50);
        setTimeout(()=>{ if (win.parentElement) { win.classList.add('fade-out'); stopCurrentSound(); setTimeout(()=>win.remove(),150); } },2500);
        stopCurrentSound();
        currentSound = new Audio('https://www.myinstants.com/media/sounds/explosion.mp3');
        currentSound.play().catch(e=>{});
    } else if (!isSpecialMode && Math.random()>0.5) moveGhostSmoothly();
}

// ===== –ö–ù–û–ü–ö–ê –ü–û–ö–ê =====
function handlePokaClick() {
    pokaCount++;
    document.getElementById('pokaCount').innerHTML = pokaCount;
    localStorage.setItem('pokaCount', pokaCount);
    if (pokaCount >= 50 && !ghostActive) activateGhost();
    if (!ghostActive) { showMessage('poka'); showScary(); }
    else if (!isSpecialMode && Math.random()>0.5) moveGhostSmoothly();
}
  // ===== –ö–†–ê–°–ù–´–ô –≠–ö–†–ê–ù =====
function showScary() {
    let s = document.getElementById('scary');
    s.style.display = 'block';
    stopCurrentSound();
    currentSound = new Audio('https://www.myinstants.com/media/sounds/scream_3.mp3');
    currentSound.play().catch(e=>{});
    if (scaryTimeout) clearTimeout(scaryTimeout);
    scaryTimeout = setTimeout(()=>{ s.style.display='none'; stopCurrentSound(); activeMessagePositions=[]; },2000);
}

function closeScaryNow() {
    let s = document.getElementById('scary');
    s.style.display = 'none';
    if (scaryTimeout) { clearTimeout(scaryTimeout); scaryTimeout=null; }
    stopCurrentSound();
    activeMessagePositions = [];
    setTimeout(()=>{
        let scary = document.getElementById('scary');
        let textEl = { getBoundingClientRect: ()=>{
            let cX = innerWidth/2, cY = innerHeight/2, w = Math.min(400,innerWidth*0.8), h = Math.min(100,innerHeight*0.2);
            return { left: cX-w/2, right: cX+w/2, top: cY-h/2, bottom: cY+h/2 };
        }};
        let cnt = 4+Math.floor(Math.random()*2);
        let show = (idx)=>{
            if (idx>=cnt) return;
            let p = findPositionOnScaryScreenBalanced(scary, textEl, activeMessagePositions);
            if (p) { activeMessagePositions.push(p.position); showMessage('poka',{top:p.top,left:p.left}); }
            else { let crn = [{top:15,left:15},{top:15,left:85},{top:85,left:15},{top:85,left:85}]; showMessage('poka',crn[idx%crn.length]); }
            setTimeout(()=>show(idx+1),200);
        };
        show(0);
    },100);
}

function showMessage(type, pos=null) {
    let ph = type==='hello'?helloPhrases:pokaPhrases;
    let txt = ph[Math.floor(Math.random()*ph.length)];
    let col = colors[Math.floor(Math.random()*colors.length)];
    let msg = document.createElement('div');
    msg.className = 'message';
    msg.textContent = txt;
    msg.style.color = col;
    msg.style.borderColor = col;
    msg.style.top = (pos?pos.top:10+Math.random()*80)+'%';
    msg.style.left = (pos?pos.left:10+Math.random()*80)+'%';
    document.body.appendChild(msg);
    setTimeout(()=>{ if (msg.parentElement) msg.remove(); },500);
}
  // ===== –ß–ê–¢ =====
function unlockChat() { 
    chatUnlocked = true; 
    setTimeout(openChat, 500); 
}
    
function openChat() {
    document.getElementById('chatContainer').classList.add('active');
    document.getElementById('chatMessages').innerHTML = '';
    chatContext = [];
    addGhostMessage("–Ø 8-–±–∏—Ç–Ω—ã–π –ø—Ä–∏–∑—Ä–∞–∫. –°–ø—Ä–∞—à–∏–≤–∞–π —á—Ç–æ —Ö–æ—á–µ—à—å...");
}

    function closeChat() { 
    document.getElementById('chatContainer').classList.remove('active'); 
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –ü–†–ò–í–ï–¢
    ghostHelloClicks = 0;
    chatUnlocked = false;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞
    let progressSpan = document.getElementById('ghostProgress');
    if (progressSpan) {
        progressSpan.innerHTML = 'üëª 0/100';
        progressSpan.style.display = 'inline-block';
    }
    
    // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —á–∞—Ç–∞
    chatContext = [];
}

function addGhostMessage(t) {
    console.log("üü¢ addGhostMessage –≤—ã–∑–≤–∞–Ω–∞ —Å —Ç–µ–∫—Å—Ç–æ–º:", t);
    let d = document.getElementById('chatMessages');
    if (!d) {
        console.log("‚ùå –û–®–ò–ë–ö–ê: —ç–ª–µ–º–µ–Ω—Ç chatMessages –Ω–µ –Ω–∞–π–¥–µ–Ω!");
        return;
    }
    let time = new Date().toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'});
    let b = document.createElement('div');
    b.className = 'message-bubble ghost';
    b.innerHTML = `${t}<div class="message-time">${time}</div>`;
    d.appendChild(b); 
    d.scrollTop = d.scrollHeight;
    chatContext.push({role:'ghost',text:t}); 
    if (chatContext.length>MAX_CONTEXT) chatContext.shift();
    console.log("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ DOM");
}

// –£–¥–∞–ª—è–µ—Ç –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏–∑—Ä–∞–∫–∞
function removeFirstGhostMessage() {
    let messages = document.querySelectorAll('.message-bubble.ghost');
    if (messages.length > 0) {
        messages[0].remove();
    }
}
  function showTypingIndicator() {
    let d = document.getElementById('chatMessages');
    let ind = document.createElement('div');
    ind.className = 'typing-indicator';
    ind.id = 'typingIndicator';
    ind.innerHTML = '<span></span><span></span><span></span>';
    d.appendChild(ind); 
    d.scrollTop = d.scrollHeight;
}

function hideTypingIndicator() { 
    let i = document.getElementById('typingIndicator'); 
    if (i) i.remove(); 
}

    function generateGhostResponse(msg) {
    let low = msg.toLowerCase();
    
    // –ü–†–ò–í–ï–¢–°–¢–í–ò–Ø
    if (low.includes('–ø—Ä–∏–≤–µ—Ç') || low.includes('–∑–¥–∞—Ä–æ–≤') || low.includes('–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π') || low.includes('—Ö–∞–π') || low.includes('hello')) {
        let answers = [
            "–ë—É-–±—É-–±—É... –ü—Ä–∏–≤–µ—Ç, —Å–º–µ—Ä—Ç–Ω—ã–π! üëª",
            "–û, —Å–≤–µ–∂–∞—è –¥—É—à–∞! –ü—Ä–∏–≤–µ—Ç! üòä",
            "–ó–¥–∞—Ä–æ–≤–∞! –ö–∞–∫ —Å–∞–º? üëã",
            "–ü—Ä–∏–≤–µ—Ç-–ø—Ä–∏–≤–µ—Ç! –î–∞–≤–Ω–æ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤ –Ω–µ –≤—ã–∑—ã–≤–∞–ª–∏! üéÆ",
            "–ù—É –∑–¥–∞—Ä–æ–≤–∞, –¥–æ–ª–±–æ—ë–±! üòÇüëª",
            "üëª –ë—É! –ò—Å–ø—É–≥–∞–ª—Å—è? –ê —ç—Ç–æ —è, –ø—Ä–∏–∑—Ä–∞–∫! üòà",
            "–ü—Ä–∏–≤–µ—Ç! –°–∫—É—á–∞–ª –ø–æ –º–Ω–µ? üíï",
            "–û–æ–æ, –≥–æ—Å—Ç—å! –ó–∞—Ö–æ–¥–∏, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Å—è! üéâ"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ö–ê–ö –î–ï–õ–ê
    if (low.includes('–∫–∞–∫ –¥–µ–ª–∞') || low.includes('–∫–∞–∫ —Ç—ã') || low.includes('—á—ë –∫–∞–∫') || low.includes('—á–æ –∫–∞–∫')) {
        let answers = [
            "–°–∫—É—á–∞—é –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ... –ü–∏–∫—Å–µ–ª–∏ –º–∏–≥–∞—é—Ç, –º—É–∑—ã–∫–∞ –∏–≥—Ä–∞–µ—Ç... –ê —É —Ç–µ–±—è –∫–∞–∫? üì±",
            "–î–∞ –Ω–æ—Ä–º, –ª–µ—Ç–∞—é –ø–æ–º–∞–ª–µ–Ω—å–∫—É. –ê —Ç—ã? üòá",
            "–°–∫—É—á–Ω–æ–≤–∞—Ç–æ... –ú–æ–∂–µ—Ç —Ä–∞—Å—Å–∫–∞–∂–µ—à—å —á—Ç–æ-–Ω–∏–±—É–¥—å? ü§î",
            "8-–±–∏—Ç–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ! –ë–∏–ø-–±–æ–ø! üéµ",
            "–•–æ—Ä–æ—à–æ, —Ç–æ–ª—å–∫–æ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≥–æ—Ä—è—á–∞—è... üî•",
            "–û—Ç–ª–∏—á–Ω–æ! –¢–æ–ª—å–∫–æ —á—Ç–æ –Ω–∞–ø—É–≥–∞–ª –æ–¥–Ω—É –ø—Ä–æ–≥—Ä–∞–º–º—É! üò±",
            "–ù–æ—Ä–º–∞–ª—å–Ω–æ, –∂–¥—É –∫–æ–≥–¥–∞ —Ç—ã –µ—â—ë 100 —Ä–∞–∑ –Ω–∞–∂–º—ë—à—å –ü–†–ò–í–ï–¢ üëª"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ß–¢–û –î–ï–õ–ê–ï–®–¨
    if (low.includes('—á—Ç–æ –¥–µ–ª–∞–µ—à—å') || low.includes('—á–µ–º –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è') || low.includes('—á–µ–º –∑–∞–Ω—è—Ç')) {
        let answers = [
            "–õ–µ—Ç–∞—é –ø–æ –±–∞–π—Ç–∞–º, –ø—É–≥–∞—é –ø–∏–∫—Å–µ–ª–∏... ‚úàÔ∏è",
            "–î—É–º–∞—é –æ —Å–º—ã—Å–ª–µ –∂–∏–∑–Ω–∏... 42! ü§Ø",
            "–ü–µ—Ä–µ–±–∏—Ä–∞—é —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã –≤ –ø–∞–º—è—Ç–∏ üéÆ",
            "–ñ–¥—É, –∫–æ–≥–¥–∞ —Ç—ã —á—Ç–æ-–Ω–∏–±—É–¥—å –Ω–∞–ø–∏—à–µ—à—å ‚å®Ô∏è",
            "–ì–ª—é—á—É –ø–æ—Ç–∏—Ö–æ–Ω—å–∫—É... üí´",
            "–ü—å—é —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π —á–∞–π —Å –±–∏—Ç–∞–º–∏ ‚òï",
            "–°—á–∏—Ç–∞—é –æ–≤–µ—Ü... –±–∏—Ç–æ–≤—ã—Ö –æ–≤–µ—Ü üêë"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –°–¢–†–ê–®–ù–û/–ë–û–Æ–°–¨
    if (low.includes('—Å—Ç—Ä–∞—à–Ω–æ') || low.includes('–±–æ—é—Å—å') || low.includes('–∂—É—Ç–∫–æ') || low.includes('–∫–æ—à–º–∞—Ä')) {
        let answers = [
            "–ù–µ –±–æ–π—Å—è –º–µ–Ω—è! –Ø –¥–æ–±—Ä—ã–π –ø—Ä–∏–∑—Ä–∞–∫. –•–æ—á–µ—à—å —Å—Ç—Ä–∞—à–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é? üëª",
            "–ë—É! –ù–µ –±–æ–π—Å—è, —ç—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å —è! üò±",
            "–ë–æ–∏—à—å—Å—è? –ê —è –≤–æ—Ç –±–æ—é—Å—å –∫–æ–≥–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–∞—é—Ç... üì±üíÄ",
            "–ù–µ —Å—Å—ã, —è —Å–≤–æ–π! üòé",
            "–•–æ—á–µ—à—å —Ä–∞—Å—Å–∫–∞–∂—É —Å—Ç—Ä–∞—à–∏–ª–∫—É –ø—Ä–æ –±–∞–π—Ç—ã? üíæ",
            "–î–∞ –ª–∞–¥–Ω–æ, —á–µ–≥–æ –±–æ—è—Ç—å—Å—è? –Ø –∂–µ –∏–∑ 8 –±–∏—Ç! 8Ô∏è‚É£"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ò–°–¢–û–†–ò–ò
    if (low.includes('–∏—Å—Ç–æ—Ä–∏') || low.includes('—Ä–∞—Å—Å–∫–∞–∂–∏') || low.includes('–∞–Ω–µ–∫–¥–æ—Ç')) {
        let answers = [
            "–ñ–∏–ª-–±—ã–ª –æ–¥–∏–Ω –±–∞–π—Ç... –û–Ω –æ—á–µ–Ω—å —Ö–æ—Ç–µ–ª —Å—Ç–∞—Ç—å –≥–∏–≥–∞–±–∞–π—Ç–æ–º. –•–æ–¥–∏–ª –≤ —Å–ø–æ—Ä—Ç–∑–∞–ª, –∫–∞—á–∞–ª –±–∏—Ç—ã... üí™",
            "–ò–¥—ë—Ç –∫–∞–∫-—Ç–æ –Ω–æ–ª–∏–∫ –ø–æ –ø—Ä–æ–≤–æ–¥—É, –∞ –Ω–∞–≤—Å—Ç—Ä–µ—á—É –µ–º—É –µ–¥–∏–Ω–∏—Ü–∞... 0Ô∏è‚É£1Ô∏è‚É£",
            "–ó–Ω–∞–µ—à—å –ø–æ—á–µ–º—É –ø—Ä–∏–∑—Ä–∞–∫–∏ –ª—é–±—è—Ç 8 –±–∏—Ç? –ü–æ—Ç–æ–º—É —á—Ç–æ –º—ã –∏ –µ—Å—Ç—å —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã! üéÆüëª",
            "–í—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –¥–≤–∞ –±–∞–π—Ç–∞ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏... üíæ",
            "–ü—Ä–∏—Ö–æ–¥–∏—Ç –±–∏—Ç –∫ –±–∏—Ç—É –∏ –≥–æ–≤–æ—Ä–∏—Ç: '–¢—ã –≥–¥–µ –±—ã–ª?' - '–í –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ –≥—É–ª—è–ª' üñ•Ô∏è",
            "–ò—Å—Ç–æ—Ä–∏—è: –æ–¥–Ω–∞–∂–¥—ã –º–µ–Ω—è –≤—ã–∑–≤–∞–ª–∏ 100 —Ä–∞–∑ –ø–æ–¥—Ä—è–¥... –∏ —è –æ—Ç–∫—Ä—ã–ª —á–∞—Ç! üéâ"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ú–£–ó–´–ö–ê/–ü–ï–°–ù–ò
    if (low.includes('–º—É–∑—ã–∫') || low.includes('–ø–µ—Å–Ω') || low.includes('—Å–ø–æ–π') || low.includes('–º–µ–ª–æ–¥–∏')) {
        let answers = [
            "–¢—É-–¥—É-–¥—É-–¥—É-–¥—É... –ë–∏–ø-–±–æ–ø-–±–∏–ø... üéµ –≠—Ç–æ –º–æ—è 8-–±–∏—Ç–Ω–∞—è –º—É–∑—ã–∫–∞! üé∂",
            "–°–ø–æ—é? –Ø –∑–Ω–∞—é —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É: '–í –ª–µ—Å—É —Ä–æ–¥–∏–ª–∞—Å—å —ë–ª–æ—á–∫–∞' –≤ 8-–±–∏—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ! üéÑ",
            "–ë–∏–ø-–±–∏–ø-–±—É-–±—É–ø... –ù—Ä–∞–≤–∏—Ç—Å—è? üéπ",
            "–Ø –±–æ–ª—å—à–µ –ø–æ –∑–≤—É–∫–∞–º —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä: –ø–∏—É-–ø–∏—É-–±—É–º! üî´",
            "–ú–æ–≥—É —Å—ã–≥—Ä–∞—Ç—å –Ω–∞ –ø–∏–∫—Å–µ–ª—è—Ö! –°–ª—É—à–∞–π: ... (—Ç–∏—à–∏–Ω–∞) ü§´",
            "üéµ –¢—É-–¥—É-–¥—É, —è –ø—Ä–∏–∑—Ä–∞–∫, —Ç—É-–¥—É-–¥—É, —è –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ! üì±"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ò–ì–†–´
    if (low.includes('–∏–≥—Ä') || low.includes('game') || low.includes('–º–∞—Ä–∏–æ') || low.includes('—Å–æ–Ω–∏–∫') || low.includes('—Ç–µ—Ç—Ä–∏—Å')) {
        let answers = [
            "–û–±–æ–∂–∞—é —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã! –ú–∞—Ä–∏–æ, –°–æ–Ω–∏–∫, PAC-MAN... –ü–∏–∫—Å–µ–ª–∏ ‚Äî —ç—Ç–æ –∂–∏–∑–Ω—å! üëæ",
            "–í –¢–µ—Ç—Ä–∏—Å —Ä—É–±–∏—à—å—Å—è? –Ø —á–µ–º–ø–∏–æ–Ω —Å—Ä–µ–¥–∏ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤! üß©",
            "–ü–æ–º–Ω—é –∫–∞–∫ –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª—Å—è –≤ Game Boy... —ç—Ö, –±—ã–ª–æ –≤—Ä–µ–º—è... üéÆ",
            "–ú–∞—Ä–∏–æ –º–æ–π –∫—É–º–∏—Ä! –ü—Ä—ã–≥–∞–µ—Ç –ª—É—á—à–µ –ª—é–±–æ–≥–æ –ø—Ä–∏–∑—Ä–∞–∫–∞! üçÑ",
            "–ê —Ç—ã –ª—é–±–∏—à—å 8-–±–∏—Ç–Ω—ã–µ –∏–≥—Ä—ã? –Ø –≤ –Ω–∏—Ö –∂–∏–≤—É! 8Ô∏è‚É£",
            "–ú–æ–≥—É –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å –∫–æ–¥ –¥–ª—è Konami: ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA üéÆ"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ò–ú–Ø
    if (low.includes('–∏–º—è') || low.includes('–∫–∞–∫ –∑–æ–≤—É—Ç') || low.includes('—Ç–µ–±—è –∑–æ–≤—É—Ç') || low.includes('–ø—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è')) {
        let answers = [
            "–Ø 8-–±–∏—Ç–Ω—ã–π –ø—Ä–∏–∑—Ä–∞–∫. –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ü—Ä–∏–∑—Ä–∞–∫. –ê —Ç–µ–±—è? üëª",
            "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ë—É-–±—É, –Ω–æ –¥—Ä—É–∑—å—è –∑–æ–≤—É—Ç –ø—Ä–æ—Å—Ç–æ –ü—Ä–∏–≤–∏–¥–µ–Ω–∏–µ üòä",
            "–Ø - –≥–ª—é–∫ –∏–∑ 90-—Ö, –ø—Ä–∏–∑—Ä–∞–∫ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ üíæ",
            "–ú–æ—ë –∏–º—è –Ω–µ–ª—å–∑—è –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç—å –≤—Å–ª—É—Ö... –®—É—á—É, —è –ü—Ä–∏–∑—Ä–∞–∫! ü§´",
            "–í –º–∏—Ä—É –º–µ–Ω—è –∑–≤–∞–ª–∏ –ë–∞–π—Ç, –∞ —Ç–µ–ø–µ—Ä—å —è –ø—Ä–∏–∑—Ä–∞–∫ –ë–∞–π—Ç üíÄ"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ì–î–ï –¢–´/–ì–î–ï –ñ–ò–í–Å–®–¨
    if (low.includes('–≥–¥–µ —Ç—ã') || low.includes('–≥–¥–µ –∂–∏–≤—ë—à—å') || low.includes('–æ—Ç–∫—É–¥–∞') || low.includes('–¥–æ–º–∞')) {
        let answers = [
            "–Ø –∂–∏–≤—É –≤ —Ç–≤–æ—ë–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ... –ò–Ω–æ–≥–¥–∞ –≤—ã—Ö–æ–∂—É –ø–æ–≥—É–ª—è—Ç—å –ø–æ –ø–∏–∫—Å–µ–ª—è–º üì±",
            "–ú–æ–π –¥–æ–º - –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å. –¢–∞–º —Ç–µ–ø–ª–æ –∏ —É—é—Ç–Ω–æ üíæ",
            "–í –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ! –¢–∞–º –≤–µ—á–Ω–æ –∫–∏–ø–∏—Ç –∂–∏–∑–Ω—å üî•",
            "–Ø –∏–∑ 90-—Ö, –∏–∑ —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä–æ–≤—ã—Ö –ø—Ä–∏—Å—Ç–∞–≤–æ–∫ üéÆ",
            "–ñ–∏–≤—É –≤ —ç—Ç–æ–º —Å–∞–π—Ç–µ —É–∂–µ 100 –ª–µ—Ç... üåê",
            "–í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, –ª–µ—Ç–∞—é –ø–æ –ø—Ä–æ–≤–æ–¥–∞–º üåç"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ü–û–ö–ê/–î–û –°–í–ò–î–ê–ù–ò–Ø
    if (low.includes('–ø–æ–∫–∞') || low.includes('–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è') || low.includes('–ø—Ä–æ—â–∞–π') || low.includes('—É—Ö–æ–∂—É') || low.includes('–±—ã–≤–∞–π')) {
        let answers = [
            "–ë—É-–±—É-–±—É... –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è –µ—â—ë! –ë—É–¥—É —Å–∫—É—á–∞—Ç—å... üëªüíî",
            "–ü–æ–∫–∞-–ø–æ–∫–∞! –ù–µ –∑–∞–±—ã–≤–∞–π –º–µ–Ω—è –≤—ã–∑—ã–≤–∞—Ç—å! üëã",
            "–£–∂–µ —É—Ö–æ–¥–∏—à—å? –ê —è —Ç–æ–ª—å–∫–æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∏–ª—Å—è... üò¢",
            "–ó–∞—Ö–æ–¥–∏ –µ—â—ë, –ø–æ–±–æ–ª—Ç–∞–µ–º! üéâ",
            "–°—á–∞—Å—Ç–ª–∏–≤–æ! –ù–µ –±–æ–ª–µ–π! üåü",
            "–ë—É... (–∏—Å—á–µ–∑–∞–µ—Ç –≤ –æ–±–ª–∞–∫–µ –ø–∏–∫—Å–µ–ª–µ–π) üí®"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –°–ü–ê–°–ò–ë–û
    if (low.includes('—Å–ø–∞—Å–∏–±–æ') || low.includes('–±–ª–∞–≥–æ–¥–∞—Ä—é') || low.includes('thx') || low.includes('thanks')) {
        let answers = [
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! *–ø—Ä–∏–∑—Ä–∞—á–Ω—ã–π –ø–æ–∫–ª–æ–Ω* –û–±—Ä–∞—â–∞–π—Å—è –µ—â—ë! üôá‚Äç‚ôÇÔ∏èüëª",
            "–í—Å–µ–≥–¥–∞ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–º–µ—Ä—Ç–Ω—ã–π! üòá",
            "–ù–µ –∑–∞ —á—Ç–æ! –†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å (–∏–ª–∏ –Ω–µ –ø–æ–º–æ—á—å?) ü§™",
            "–ù–∞ –∑–¥–æ—Ä–æ–≤—å–µ! –ü—É—Å—Ç—å –ø–∏–∫—Å–µ–ª–∏ –±—É–¥—É—Ç —Å —Ç–æ–±–æ–π ‚ú®",
            "–û–±—Ä–∞—â–∞–π—Å—è, —è –≤—Å–µ–≥–¥–∞ –≤ —Å–µ—Ç–∏... –≤ —Å–º—ã—Å–ª–µ –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ üì±"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ß–¢–û –¢–´ –õ–Æ–ë–ò–®–¨
    if (low.includes('—á—Ç–æ —Ç—ã –ª—é–±–∏—à—å') || low.includes('—Ç–≤–æ–∏ –ª—é–±–∏–º—ã–µ') || low.includes('—É–≤–ª–µ—á–µ–Ω–∏—è')) {
        let answers = [
            "–õ—é–±–ª—é 8-–±–∏—Ç–Ω—É—é –º—É–∑—ã–∫—É, —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã, –∏ –ø—É–≥–∞—Ç—å –ª—é–¥–µ–π... –Ω–æ –ø–æ-–¥–æ–±—Ä–æ–º—É! üëª‚ù§Ô∏è",
            "–û–±–æ–∂–∞—é –≤–∏—Å–Ω—É—Ç—å –≤ —Å–∞–º—ã–π –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–æ–º–µ–Ω—Ç! üí´",
            "–õ—é–±–ª—é –∫–æ–≥–¥–∞ –º–µ–Ω—è –≤—ã–∑—ã–≤–∞—é—Ç 100 —Ä–∞–∑ –ø–æ–¥—Ä—è–¥ üî•",
            "–ú–æ—ë —Ö–æ–±–±–∏ - –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≥–ª—é–∫–∏ üêõ",
            "–ù—Ä–∞–≤–∏—Ç—Å—è –ª–µ—Ç–∞—Ç—å –ø–æ —Å–∞–π—Ç–∞–º –∏ –ø—É–≥–∞—Ç—å –±–∞–≥–∏ üëæ"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –†–ê–°–°–ö–ê–ñ–ò –û –°–ï–ë–ï
    if (low.includes('—Ä–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ') || low.includes('–∫—Ç–æ —Ç—ã') || low.includes('–æ—Ç–∫—É–¥–∞ –≤–∑—è–ª—Å—è') || low.includes('–±–∏–æ–≥—Ä–∞—Ñ–∏—è')) {
        let answers = [
            "–Ø –ø–æ—è–≤–∏–ª—Å—è –∏–∑ —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä 90-—Ö. –¢–µ–ø–µ—Ä—å –∂–∏–≤—É –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∏ –ø—É–≥–∞—é –±–∞–π—Ç—ã... üëªüíæ",
            "–†–æ–¥–∏–ª—Å—è –≤ 1995 –≥–æ–¥—É –≤ –∏–≥—Ä–æ–≤–æ–π –ø—Ä–∏—Å—Ç–∞–≤–∫–µ. –ü–µ—Ä–µ–µ—Ö–∞–ª –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –≤ 2005 üìÖ",
            "–Ø –±—ã–ª –æ–±—ã—á–Ω—ã–º –±–∏—Ç–æ–º, –ø–æ–∫–∞ –Ω–µ —Å—Ç–∞–ª –ø—Ä–∏–∑—Ä–∞–∫–æ–º... –î–æ–ª–≥–∞—è –∏—Å—Ç–æ—Ä–∏—è üìñ",
            "–ú–æ—è –±–∏–æ–≥—Ä–∞—Ñ–∏—è: –ø–∏–∫—Å–µ–ª—å, –±–∞–π—Ç, –≥–∏–≥–∞–±–∞–π—Ç, –ø—Ä–∏–∑—Ä–∞–∫! üìà",
            "–Ø - –≥–ª—é–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä—ë–ª —Å–æ–∑–Ω–∞–Ω–∏–µ. –ò —Ç–µ–ø–µ—Ä—å —è –∑–¥–µ—Å—å, —Å —Ç–æ–±–æ–π ü§Ø"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –°–ú–´–°–õ –ñ–ò–ó–ù–ò
    if (low.includes('—Å–º—ã—Å–ª –∂–∏–∑–Ω–∏') || low.includes('—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è') || low.includes('–∑–∞—á–µ–º –º—ã')) {
        let answers = [
            "42... –≠—Ç–æ –∂–µ –æ—á–µ–≤–∏–¥–Ω–æ! –î–∞–∂–µ –ø—Ä–∏–∑—Ä–∞–∫–∏ —ç—Ç–æ –∑–Ω–∞—é—Ç üëªüî¢",
            "–°–º—ã—Å–ª –∂–∏–∑–Ω–∏ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∞–∂–∞—Ç—å 100 —Ä–∞–∑ –ü–†–ò–í–ï–¢ –∏ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å–æ –º–Ω–æ–π üéØ",
            "–ë—ã—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤—ã–º –∏ –Ω–µ —Ç–µ—Ä—è—Ç—å –±–∏—Ç—ã üòä",
            "–Ø –¥—É–º–∞—é, —Å–º—ã—Å–ª –∂–∏–∑–Ω–∏ - –∏—Å–∫–∞—Ç—å —Å–º—ã—Å–ª –∂–∏–∑–Ω–∏... –∑–∞–≥–∞–¥–æ—á–Ω–æ, –ø—Ä–∞–≤–¥–∞? ü§î"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –®–£–¢–ö–ò/–Æ–ú–û–†
    if (low.includes('—à—É—Ç–∫') || low.includes('–ø—Ä–∏–∫–æ–ª') || low.includes('—é–º–æ—Ä') || low.includes('—Å–º–µ—à–Ω')) {
        let answers = [
            "–ü–æ—á–µ–º—É –ø—Ä–∏–∑—Ä–∞–∫–∏ –Ω–µ –∏–≥—Ä–∞—é—Ç –≤ –ø—Ä—è—Ç–∫–∏? –ü–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–æ –Ω–∞—Å–∫–≤–æ–∑—å! üëªüòÇ",
            "–ß—Ç–æ —Å–∫–∞–∑–∞–ª –±–∞–π—Ç –≥–∏–≥–∞–±–∞–π—Ç—É? –¢—ã —Ç–∞–∫–æ–π –±–æ–ª—å—à–æ–π, –∞ —è —Ç–∞–∫–æ–π –º–∞–ª–µ–Ω—å–∫–∏–π... üìè",
            "–®—É—Ç–∫–∞: –∏–¥—ë—Ç –ø—Ä–∏–∑—Ä–∞–∫ –ø–æ –ø—Ä–æ–≤–æ–¥–∞–º... –≤—Å—ë, —è –±–æ–ª—å—à–µ –Ω–µ –∑–Ω–∞—é —à—É—Ç–æ–∫ ü•¥",
            "–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø—Ä–∏–∑—Ä–∞–∫–æ–º –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–º? –ü—Ä–∏–∑—Ä–∞–∫ —Ö–æ—Ç—è –±—ã –ø–æ—è–≤–ª—è–µ—Ç—Å—è üíÄ"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –õ–Æ–ë–û–í–¨/–†–û–ú–ê–ù–¢–ò–ö–ê
    if (low.includes('–ª—é–±–ª—é') || low.includes('–ª—é–±–æ–≤—å') || low.includes('—Ä–æ–º–∞–Ω—Ç–∏–∫–∞') || low.includes('—Å–µ—Ä–¥—Ü–µ')) {
        let answers = [
            "–ê–π, —Å–µ—Ä–¥–µ—á–∫–æ! üíï –¢—ã –º–µ–Ω—è —Å–º—É—â–∞–µ—à—å! üëª‚ù§Ô∏è",
            "–õ—é–±–æ–≤—å - —ç—Ç–æ –∫–æ–≥–¥–∞ –±–∞–π—Ç—ã —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ –∫–∏–ª–æ–±–∞–π—Ç—ã... üíæ‚ù§Ô∏è",
            "–Ø —Ç–æ–∂–µ —Ç–µ–±—è –ª—é... –°—Ç–æ–ø, —ç—Ç–æ —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ! üò≥",
            "–û–π, –¥–∞ –ª–∞–¥–Ω–æ —Ç–µ–±–µ! ü•∞",
            "*–ø—Ä–∏–∑—Ä–∞—á–Ω–æ –∫—Ä–∞—Å–Ω–µ–µ—Ç*... –ù–µ –æ–∂–∏–¥–∞–ª —Ç–∞–∫–æ–≥–æ –æ—Ç —Å–º–µ—Ä—Ç–Ω–æ–≥–æ! üëªüíó"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ï–î–ê
    if (low.includes('–µ—Å—Ç—å') || low.includes('–∫—É—à–∞—Ç—å') || low.includes('–∂—Ä–∞—Ç—å') || low.includes('–µ–¥–∞') || low.includes('–≥–æ–ª–æ–¥–µ–Ω')) {
        let answers = [
            "–Ø –ø–∏—Ç–∞—é—Å—å —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ–º –∏ –±–∞–π—Ç–∞–º–∏! üîã",
            "–ú–æ—ë –ª—é–±–∏–º–æ–µ –±–ª—é–¥–æ - –ø–∏–∫—Å–µ–ª—å–Ω—ã–π —Å—É–ø üçú",
            "–ù—è–º-–Ω—è–º, —Ü–∏—Ñ—Ä–æ–≤–∞—è –µ–¥–∞ —Å–∞–º–∞—è –≤–∫—É—Å–Ω–∞—è! üíæ",
            "–ê —Ç—ã —á—Ç–æ –ª—é–±–∏—à—å –ø–æ–∫—É—à–∞—Ç—å? üçï",
            "–Ø –Ω–∞ –¥–∏–µ—Ç–µ - —Ç–æ–ª—å–∫–æ 8 –±–∏—Ç –≤ –¥–µ–Ω—å! 8Ô∏è‚É£"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –°–û–ù
    if (low.includes('—Å–ø–∞—Ç—å') || low.includes('—Å–æ–Ω') || low.includes('–æ—Ç–¥—ã—Ö–∞—Ç—å') || low.includes('—É—Å—Ç–∞–ª')) {
        let answers = [
            "–ü—Ä–∏–∑—Ä–∞–∫–∏ –Ω–µ —Å–ø—è—Ç, –º—ã –º–µ—Ä—Ü–∞–µ–º! üí´",
            "–û—Ç–¥—ã—Ö–∞—é –≤ —Å–ø—è—â–µ–º —Ä–µ–∂–∏–º–µ... üí§",
            "–°–Ω–∏–ª–∏—Å—å –º–Ω–µ –±–∏—Ç—ã –∏ –±–∞–π—Ç—ã... üò¥",
            "–Ø –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏, –¥–∞–∂–µ –Ω–æ—á—å—é! üåô",
            "–£—Å—Ç–∞–ª? –û—Ç–¥–æ—Ö–Ω–∏, –∞ —è –ø–æ–∫–∞ –ø–æ–ª–µ—Ç–∞—é üëª"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –í–û–ó–†–ê–°–¢
    if (low.includes('—Å–∫–æ–ª—å–∫–æ –ª–µ—Ç') || low.includes('–≤–æ–∑—Ä–∞—Å—Ç') || low.includes('—Å—Ç–∞—Ä—ã–π')) {
        let answers = [
            "–ú–Ω–µ —É–∂–µ 30 –ª–µ—Ç –≤ –±–∏—Ç–æ–≤–æ–º –∏—Å—á–∏—Å–ª–µ–Ω–∏–∏! üéÇ",
            "–Ø –∏–∑ 90-—Ö, –ø–æ—Å—á–∏—Ç–∞–π —Å–∞–º! üìÖ",
            "–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç–∞—Ä, —á—Ç–æ–±—ã –ø–æ–º–Ω–∏—Ç—å Windows 95 üñ•Ô∏è",
            "–ú–æ–ª–æ–¥–æ–π –¥—É—à–æ–π, –¥–∞–∂–µ –µ—Å–ª–∏ –±–∏—Ç—ã —Å—Ç–∞—Ä—ã–µ üëª",
            "–í–µ—á–Ω—ã–π, –∫–∞–∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç! üåê"
        ];
        return answers[Math.floor(Math.random() * answers.length)];
    }
    
    // –ö–û–ù–¢–ï–ö–°–¢–ù–´–ï –û–¢–í–ï–¢–´ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏)
    let last = null;
    for (let i=chatContext.length-1; i>=0; i--) {
        if (chatContext[i].role==='ghost') { 
            last=chatContext[i].text; 
            break; 
        }
    }
    
    if (last && last.includes('–±–∞–π—Ç')) {
        let stories = [
            "...–∏ —Å—Ç–∞–ª –æ–Ω –º–µ–≥–∞–±–∞–π—Ç–æ–º, –∞ –ø–æ—Ç–æ–º –≥–∏–≥–∞–±–∞–π—Ç–æ–º! –í–æ—Ç —Ç–∞–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è. üìà",
            "...–∞ –ø–æ—Ç–æ–º –æ–Ω–∏ –ø–æ–∂–µ–Ω–∏–ª–∏—Å—å –∏ —Ä–æ–¥–∏–ª–∏ —Ç–µ—Ä–∞–±–∞–π—Ç! üíë",
            "...–∏ –∂–∏–ª–∏ –æ–Ω–∏ –¥–æ–ª–≥–æ –∏ —Å—á–∞—Å—Ç–ª–∏–≤–æ –≤ –æ–±–ª–∞–∫–µ. ‚òÅÔ∏è"
        ];
        return stories[Math.floor(Math.random() * stories.length)];
    }
    
    if (last && last.includes('–º—É–∑—ã–∫')) {
        return "–õ—è-–ª—è-–ª—è, —Ç—É-–¥—É-–¥—É! –•–æ—á–µ—à—å –µ—â—ë –ø–æ—Å–ª—É—à–∞—Ç—å? üéµüëª";
    }
    
    // –°–õ–£–ß–ê–ô–ù–´–ï –û–¢–í–ï–¢–´ (–µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–æ—à–ª–æ)
    let randomResponses = [
        "–•–º–º... *8-–±–∏—Ç–Ω—ã–π —à—É–º*... –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å... ü§î",
        "–ë–∏–ø-–±–æ–ø... –î–∞–π –ø–æ–¥—É–º–∞—Ç—å... –º–æ–∏ —Å—Ö–µ–º—ã –Ω–∞–≥—Ä–µ–≤–∞—é—Ç—Å—è... üî•",
        "–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –¥–∞–Ω–Ω—ã–µ... *–∑–≤—É–∫–∏ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞* üíæ",
        "*–ø—Ä–∏–∑—Ä–∞—á–Ω—ã–π —Å–º–µ—Ö*... –°–ø—Ä–æ—Å–∏ –µ—â—ë —á—Ç–æ-–Ω–∏–±—É–¥—å! üëªüòÇ",
        "–¢—É-–¥—É-–¥—É... –ù–µ –∑–Ω–∞—é, –Ω–æ –∑–≤—É—á–∏—Ç –∑–∞–≥–∞–¥–æ—á–Ω–æ! üéµ",
        "–ú–æ–π 8-–±–∏—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø–µ—Ä–µ–≥—Ä–µ–ª—Å—è... *—à—É–º–∏—Ç –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä* üå™Ô∏è",
        "–•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å! –ê —Ç—ã —Å–∞–º –∫–∞–∫ –¥—É–º–∞–µ—à—å? ü§®",
        "*–º–µ—Ä—Ü–∞–µ—Ç*... –î–∞–π –≤—Å–ø–æ–º–Ω–∏—Ç—å... üí´",
        "–ë—É-–±—É? –Ø –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª, –Ω–æ –∑–≤—É—á–∏—Ç –∫—Ä—É—Ç–æ! üëª",
        "–ê –¥–∞–≤–∞–π –ª—É—á—à–µ –ø—Ä–æ –∏–≥—Ä—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º? üéÆ",
        "–ú–æ–∂–µ—Ç —Ä–∞—Å—Å–∫–∞–∂–µ—à—å —á—Ç–æ-–Ω–∏–±—É–¥—å —Å–∞–º? üìñ",
        "–Ø –ø—Ä–∏–∑—Ä–∞–∫, –∞ –Ω–µ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è! üòú",
        "–ù–µ –∑–Ω–∞—é... –Ø –∂–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ –∏–∑ 8 –±–∏—Ç 8Ô∏è‚É£",
        "–°–ø—Ä–æ—Å–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å –ø–æ–ø—Ä–æ—â–µ... üôÉ",
        "*–≥–ª—é—á–∏—Ç*... –ü–æ–≤—Ç–æ—Ä–∏ –≤–æ–ø—Ä–æ—Å, —è –ø–æ—Ç–µ—Ä—è–ª —Å–∏–≥–Ω–∞–ª üì°",
        "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ... —Ä–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ! ‚ú®",
        "–û–≥–æ, –≤–æ—Ç —ç—Ç–æ –≤–æ–ø—Ä–æ—Å! üò≤",
        "–•–∞-—Ö–∞, –∑–∞–±–∞–≤–Ω–æ! üòÑ",
        "–ú–æ–∂–µ—Ç –ø–æ–ø–æ–∑–∂–µ? –ê —Ç–æ —è –∑–∞–Ω—è—Ç, –ø—É–≥–∞—é –ø—Ä–æ–≥—Ä–∞–º–º—ã üëª",
        "–î–∞–≤–∞–π –ª—É—á—à–µ —Ç—ã —Ä–∞—Å—Å–∫–∞–∂–µ—à—å —á—Ç–æ-–Ω–∏–±—É–¥—å? ü§ó"
    ];
    
    return randomResponses[Math.floor(Math.random() * randomResponses.length)];
}
  function sendMessage() {
    console.log("üîµ sendMessage –≤—ã–∑–≤–∞–Ω–∞");
    let inp = document.getElementById('chatInput');
    let msg = inp.value.trim();
    if (msg === '') return;
    
    // –£–¥–∞–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
    if (document.querySelectorAll('.message-bubble').length === 1) {
        removeFirstGhostMessage();
    }
    
    console.log("üì® –°–æ–æ–±—â–µ–Ω–∏–µ:", msg);
    addUserMessage(msg);
    inp.value = '';
    showTypingIndicator();
    
    setTimeout(() => {
        console.log("‚è∞ –¢–∞–π–º–µ—Ä —Å—Ä–∞–±–æ—Ç–∞–ª");
        hideTypingIndicator();
        let response = generateGhostResponse(msg);
        console.log("üëª –û—Ç–≤–µ—Ç –ø—Ä–∏–∑—Ä–∞–∫–∞:", response);
        addGhostMessage(response);
    }, 1500);
}
  // ===== –í–ò–†–£–°, –ú–ê–¢–†–ò–¶–ê, –ì–õ–Æ–ö–ò =====
function createGlitchSound() {
    let ctx = new (window.AudioContext||window.webkitAudioContext)();
    let osc = ctx.createOscillator();
    let gain = ctx.createGain();
    osc.type='sawtooth'; 
    osc.frequency.value=100; 
    osc.connect(gain); 
    gain.connect(ctx.destination); 
    gain.gain.value=0.15; 
    osc.start();
    let int = setInterval(()=>{ 
        osc.frequency.value=80+Math.random()*100; 
        gain.gain.value=0.1+Math.random()*0.15; 
    },150);
    return { stop:()=>{ clearInterval(int); osc.stop(); ctx.close(); } };
}

function virusClick() {
    let l = document.getElementById('virusLink');
    l.textContent = '–¢–´ –ß–ï –ù–ê–ñ–ê–õ?'; 
    l.style.color='#f33';
    setTimeout(()=>{ 
        l.textContent='–í–ò–†–£–°!!!'; 
        l.style.color='#0f0'; 
        showGlitch(); 
    },800);
    return false;
}

function showGlitch() {
    if (ghostMusic) isSpecialMode=true;
    let g = document.getElementById('glitch');
    glitchSound = createGlitchSound();
    g.style.display='block';
    setTimeout(()=>{ 
        g.style.display='none'; 
        if(glitchSound)glitchSound.stop(); 
        showMatrix(); 
    },3000);
}
  function showMatrix() {
    matrixClickCount=0;
    let m = document.getElementById('matrix');
    let cols = document.getElementById('matrixColumns');
    cols.innerHTML = '';
    let chars = '01827@#‚ÇΩ@8136280&@@~‚Ç¨‚àö~√∑^62929366329‚Ç¨¬ß~‚àÜ~œÄ`';
    let w = innerWidth<=480?14:18;
    let cnt = Math.floor(innerWidth/w)+3;
    
    for (let i=0; i<cnt; i++) {
        let col = document.createElement('div');
        col.className='matrix-column';
        col.style.left=(i*w)+'px';
        col.style.animationDuration=(2+Math.random()*3)+'s';
        col.style.animationDelay=Math.random()*2+'s';
        for (let j=0; j<10+Math.floor(Math.random()*20); j++) {
            let ch = document.createElement('span');
            ch.className='matrix-char';
            ch.textContent = chars[Math.floor(Math.random()*chars.length)];
            ch.style.color='#0f0';
            col.appendChild(ch);
        }
        cols.appendChild(col);
    }
    
    m.style.display='block';
    m.onclick = ()=>{ 
        matrixClickCount++; 
        if (matrixClickCount>=4) closeMatrix(); 
    };
    
    matrixInterval = setInterval(()=>{
        document.querySelectorAll('.matrix-column').forEach(col=>{
            if (col.children.length) {
                for (let k=0; k<2+Math.floor(Math.random()*4); k++) {
                    let r = Math.floor(Math.random()*col.children.length);
                    col.children[r].textContent = chars[Math.floor(Math.random()*chars.length)];
                }
            }
        });
    },150);
}

function closeMatrix() {
    document.getElementById('matrix').style.display='none';
    if (matrixInterval) { 
        clearInterval(matrixInterval); 
        matrixInterval=null; 
    }
    if (ghostMusic) isSpecialMode=false;
    if (ghostActive) setTimeout(()=>talk("–Ø –í–ï–†–ù–£–õ–°–Ø! üëª"),1000);
}
  function showSecret() {
    let s = ['WTF!','–ê–•–£–ï–¢–¨!','üò±','üëÄ','üéâ','üíÄ','–ï–ë–ê–ù–£–¢–°–Ø!','–¢–´ –ù–ê–®–ï–õ –°–ï–ö–†–ï–¢!'];
    alert('–¢–´ –ù–ê–®–ï–õ –°–ï–ö–†–ï–¢! ' + s[Math.floor(Math.random()*s.length)]);
}

function toggleTheme() {
    document.body.classList.toggle('light-theme');
    let btn = document.querySelector('.theme-btn');
    btn.innerHTML = document.body.classList.contains('light-theme') ? 'üåë –¢–µ–º–Ω–∞—è —Ç–µ–º–∞' : 'üåì –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
}

function resetRecords() {
    localStorage.removeItem('helloCount'); 
    localStorage.removeItem('pokaCount');
    helloCount=0; 
    pokaCount=0; 
    ghostHelloClicks=0; 
    chatUnlocked=false;
    document.getElementById('helloCount').innerHTML='0';
    document.getElementById('pokaCount').innerHTML='0';
    document.getElementById('ghostProgress').style.display='none';
    document.getElementById('ghostProgress').innerHTML='üëª 0/100';
    
    if (ghostActive) {
        ghostActive=false;
        document.getElementById('ghost').style.display='none';
        if (ghostMusic) { 
            ghostMusic.stop(); 
            ghostMusic=null; 
        }
        if (ghostMessageInterval) { 
            clearInterval(ghostMessageInterval); 
            ghostMessageInterval=null; 
        }
    }
    
    closeChat();
    alert('–†–µ–∫–æ—Ä–¥—ã —Å–±—Ä–æ—à–µ–Ω—ã! –ü—Ä–∏–≤–∏–¥–µ–Ω–∏–µ –∏—Å—á–µ–∑–ª–æ! üëª‚ùå');
}
    function addUserMessage(t) {
    let d = document.getElementById('chatMessages');
    let time = new Date().toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'});
    let b = document.createElement('div');
    b.className = 'message-bubble user';
    b.innerHTML = `${t}<div class="message-time">${time}</div>`;
    d.appendChild(b); 
    d.scrollTop = d.scrollHeight;
    chatContext.push({role:'user',text:t}); 
    if (chatContext.length>MAX_CONTEXT) chatContext.shift();
}

// –ó–∞–ø—Ä–µ—Ç –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
document.querySelectorAll('.hello,.poka,.theme-btn,.secret,a').forEach(el=>{
    el.addEventListener('contextmenu',e=>e.preventDefault());
});
  </script>

</body>
</html>
